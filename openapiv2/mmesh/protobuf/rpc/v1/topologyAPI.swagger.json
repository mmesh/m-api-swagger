{
  "swagger": "2.0",
  "info": {
    "title": "mmesh-topology-api",
    "version": "1.0",
    "contact": {
      "name": "mmesh-api",
      "url": "https://github.com/mmesh/m-api"
    },
    "license": {
      "name": "Apache-2.0 License",
      "url": "https://github.com/mmesh/m-api/blob/master/LICENSE"
    }
  },
  "tags": [
    {
      "name": "TopologyAPI"
    }
  ],
  "schemes": [
    "https"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/api/v1/accounts/{accountID}/tenants/{tenantID}/networks/{netID}": {
      "get": {
        "summary": "Gets a network.",
        "operationId": "TopologyAPI_GetNetwork",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyNetwork"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "netID",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      },
      "delete": {
        "summary": "Deletes a network.",
        "operationId": "TopologyAPI_DeleteNetwork",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/emptyResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "netID",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      },
      "patch": {
        "summary": "Updates a network.",
        "operationId": "TopologyAPI_UpdateNetwork",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyNetwork"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "netID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "description": {
                  "type": "string"
                },
                "routedSubnets": {
                  "type": "boolean",
                  "title": "connect subnets within the network"
                }
              }
            }
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{accountID}/tenants/{tenantID}/networks/{netID}/subnets/{subnetID}": {
      "get": {
        "summary": "Gets a subnet.",
        "operationId": "TopologyAPI_GetSubnet",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologySubnet"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "netID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnetID",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      },
      "delete": {
        "summary": "Deletes a subnet.",
        "operationId": "TopologyAPI_DeleteSubnet",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/emptyResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "netID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnetID",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      },
      "patch": {
        "summary": "Updates a subnet.",
        "operationId": "TopologyAPI_UpdateSubnet",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologySubnet"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "netID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnetID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "description": {
                  "type": "string"
                },
                "defaultPolicy": {
                  "$ref": "#/definitions/topologySecurityPolicy",
                  "title": "ACCEPT, DROP"
                }
              }
            }
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{accountID}/tenants/{tenantID}/networks/{netID}/subnets/{subnetID}/policy": {
      "get": {
        "summary": "Gets subnet security policy.",
        "operationId": "TopologyAPI_GetNetworkPolicy",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyPolicy"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "netID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnetID",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      },
      "delete": {
        "summary": "Deletes subnet security policy.",
        "operationId": "TopologyAPI_DeleteNetworkPolicy",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyPolicy"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "netID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnetID",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{accountID}/tenants/{tenantID}/networks/{netID}/subnets/{subnetID}:ipam-entry": {
      "post": {
        "summary": "Removes an IPAM entry from a subnet.",
        "operationId": "TopologyAPI_RemoveSubnetIPAMEntry",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologySubnet"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "netID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnetID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "endpointID": {
                  "type": "string"
                },
                "IPv4": {
                  "type": "string"
                }
              }
            }
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{accountID}/tenants/{tenantID}/networks/{netID}/subnets:new": {
      "post": {
        "summary": "Creates a subnet.",
        "operationId": "TopologyAPI_CreateSubnet",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologySubnet"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "netID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "description": {
                  "type": "string"
                },
                "networkCIDR": {
                  "type": "string"
                },
                "subnetCIDR": {
                  "type": "string"
                },
                "defaultPolicy": {
                  "$ref": "#/definitions/topologySecurityPolicy",
                  "title": "ACCEPT, DROP"
                }
              }
            }
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{accountID}/tenants/{tenantID}/networks:new": {
      "post": {
        "summary": "Creates a network.",
        "operationId": "TopologyAPI_CreateNetwork",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyNetwork"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "description": {
                  "type": "string"
                },
                "networkCIDR": {
                  "type": "string"
                },
                "routedSubnets": {
                  "type": "boolean",
                  "title": "connect subnets within the network"
                },
                "locationID": {
                  "type": "string"
                }
              }
            }
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{accountID}/tenants/{tenantID}/nodes/{nodeID}": {
      "get": {
        "summary": "Gets a node.",
        "operationId": "TopologyAPI_GetNode",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyNode"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "nodeID",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      },
      "delete": {
        "summary": "Removes a node from the database.",
        "operationId": "TopologyAPI_DeleteNode",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/emptyResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "nodeID",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{accountID}/tenants/{tenantID}/nodes:new": {
      "post": {
        "summary": "Creates a node.",
        "operationId": "TopologyAPI_CreateGenericNode",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyNodeInstance"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "netID": {
                  "type": "string"
                },
                "subnetID": {
                  "type": "string"
                },
                "nodeName": {
                  "type": "string"
                },
                "description": {
                  "type": "string"
                },
                "port": {
                  "type": "integer",
                  "format": "int32"
                },
                "externalPort": {
                  "type": "integer",
                  "format": "int32"
                },
                "type": {
                  "$ref": "#/definitions/topologyNodeType"
                },
                "replicaSet": {
                  "type": "boolean"
                },
                "kubernetesAttrs": {
                  "$ref": "#/definitions/topologyKubernetesAttrs"
                }
              }
            }
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{accountID}/tenants/{tenantID}:topology": {
      "get": {
        "summary": "Get topology data (deprecated).",
        "operationId": "TopologyAPI_GetTopology",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyTopology"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{network.accountID}/tenants/{network.tenantID}/networks/{network.netID}/subnets": {
      "post": {
        "summary": "Lists subnets in a network.",
        "operationId": "TopologyAPI_ListSubnets",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologySubnets"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "network.accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "network.tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "network.netID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "meta": {
                  "$ref": "#/definitions/resourceListRequest"
                },
                "network": {
                  "type": "object"
                }
              }
            }
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{nodeReq.accountID}/tenants/{nodeReq.tenantID}/nodes/{nodeReq.nodeID}:management": {
      "patch": {
        "summary": "Updates node management configuration.",
        "operationId": "TopologyAPI_UpdateNodeManagement",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyNode"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "nodeReq.accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "nodeReq.tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "nodeReq.nodeID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "nodeReq": {
                  "type": "object"
                },
                "disableOps": {
                  "type": "boolean"
                },
                "disableExec": {
                  "type": "boolean"
                },
                "disableTransfer": {
                  "type": "boolean"
                },
                "disablePortForwarding": {
                  "type": "boolean"
                }
              }
            }
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{nodeReq.accountID}/tenants/{nodeReq.tenantID}/nodes/{nodeReq.nodeID}:metadata": {
      "patch": {
        "summary": "Updates node metadata.",
        "operationId": "TopologyAPI_UpdateNodeMetadata",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyNode"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "nodeReq.accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "nodeReq.tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "nodeReq.nodeID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "nodeReq": {
                  "type": "object"
                },
                "nodeName": {
                  "type": "string"
                },
                "description": {
                  "type": "string"
                }
              }
            }
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{nodeReq.accountID}/tenants/{nodeReq.tenantID}/nodes/{nodeReq.nodeID}:networking": {
      "patch": {
        "summary": "Updates node networking configuration.",
        "operationId": "TopologyAPI_UpdateNodeNetworking",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyNode"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "nodeReq.accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "nodeReq.tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "nodeReq.nodeID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "nodeReq": {
                  "type": "object"
                },
                "netID": {
                  "type": "string"
                },
                "subnetID": {
                  "type": "string"
                },
                "tags": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "title": "int32 priority = 41;\n bool kubernetesGw = 51;\n bool disableRelay = 61;\n bool disableNetworking = 72;"
                }
              }
            }
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{request.accountID}/tenants/{request.tenantID}/nodes/{request.nodeID}:host-metrics": {
      "get": {
        "summary": "Gets node hostMetrics.",
        "operationId": "TopologyAPI_GetNodeHostMetrics",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/metricsdbHostMetricsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "request.accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "request.tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "request.nodeID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "request.controllerID",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "request.queryID",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "timeRange",
            "description": "namespace\n\n - TTL_1H: 1H - 60min       / 30 samples - 1 point per 2min\n - TTL_6H: 6H - 360min      / 30 samples - 1 point per 12min\n - TTL_12H: 12H - 720min     / 30 samples - 1 point per 24min\n - TTL_24H: 24H - 1440min    / 30 samples - 1 point per 48min\n - TTL_7D: 7D - 10080min    / 30 samples - 1 point per 336min\n - TTL_14D: 14D - 20160min   / 30 samples - 1 point per 672min\n - TTL_30D: 30D - 40320min   / 30 samples - 1 point per 1344min\n - TTL_365D: 365D - 525600min / 30 samples - 1 point per 12days",
            "in": "query",
            "required": false,
            "type": "string",
            "enum": [
              "TTL_UNDEFINED",
              "TTL_1H",
              "TTL_6H",
              "TTL_12H",
              "TTL_24H",
              "TTL_7D",
              "TTL_14D",
              "TTL_30D",
              "TTL_365D"
            ],
            "default": "TTL_UNDEFINED"
          },
          {
            "name": "metric",
            "description": "key\n\n - NET_TX_BYTES: NET_RX_PKTS = 21;\n NET_TX_PKTS = 22;\n NET_DROPPED_PKTS = 23;",
            "in": "query",
            "required": false,
            "type": "string",
            "enum": [
              "UNDEFINED",
              "NET_RX_BYTES",
              "NET_TX_BYTES",
              "HOST_LOAD_AVG",
              "HOST_CPU_USAGE",
              "HOST_MEM_USAGE",
              "HOST_DISK_USAGE"
            ],
            "default": "UNDEFINED"
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{request.accountID}/tenants/{request.tenantID}/nodes/{request.nodeID}:host-security": {
      "get": {
        "summary": "Gets node hostSecurityReport.",
        "operationId": "TopologyAPI_GetNodeHostSecurityReport",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/hsecdbHostSecurityReportResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "request.accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "request.tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "request.nodeID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "request.controllerID",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "request.queryID",
            "in": "query",
            "required": false,
            "type": "string"
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{request.accountID}/tenants/{request.tenantID}/nodes/{request.nodeID}:net-ct-log": {
      "get": {
        "summary": "Gets node netConntrackLog.",
        "operationId": "TopologyAPI_GetNodeNetCtLog",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/netdbConntrackLogResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "request.accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "request.tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "request.nodeID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "request.controllerID",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "request.queryID",
            "in": "query",
            "required": false,
            "type": "string"
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{request.accountID}/tenants/{request.tenantID}/nodes/{request.nodeID}:net-ct-state": {
      "get": {
        "summary": "Gets node netConntrackState.",
        "operationId": "TopologyAPI_GetNodeNetCtState",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/netdbConntrackTableResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "request.accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "request.tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "request.nodeID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "request.controllerID",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "request.queryID",
            "in": "query",
            "required": false,
            "type": "string"
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{request.accountID}/tenants/{request.tenantID}/nodes/{request.nodeID}:net-traffic": {
      "get": {
        "summary": "Gets node netTrafficMetrics.",
        "operationId": "TopologyAPI_GetNodeNetTrafficMetrics",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/netdbTrafficMetricsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "request.accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "request.tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "request.nodeID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "request.controllerID",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "request.queryID",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "type",
            "in": "query",
            "required": false,
            "type": "string",
            "enum": [
              "UNKNOWN_QUERY",
              "TRAFFIC_BY_PROTOCOL",
              "TRAFFIC_BY_L5_PORT",
              "TRAFFIC_BY_DIRECTION",
              "TRAFFIC_TOP_TALKERS"
            ],
            "default": "UNKNOWN_QUERY"
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{subnet.accountID}/tenants/{subnet.tenantID}/networks/{subnet.netID}/subnets/{subnet.subnetID}/nodes": {
      "post": {
        "summary": "Lists nodes by subnet.",
        "operationId": "TopologyAPI_ListNodesBySubnet",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyNodes"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "subnet.accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnet.tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnet.netID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnet.subnetID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "meta": {
                  "$ref": "#/definitions/resourceListRequest"
                },
                "subnet": {
                  "type": "object"
                }
              }
            }
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{subnetReq.accountID}/tenants/{subnetReq.tenantID}/networks/{subnetReq.netID}/subnets/{subnetReq.subnetID}/policy": {
      "post": {
        "summary": "Creates a network filter in the subnet security policy.",
        "operationId": "TopologyAPI_CreateNetworkFilter",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyPolicy"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "subnetReq.accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnetReq.tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnetReq.netID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnetReq.subnetID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "subnetReq": {
                  "type": "object"
                },
                "index": {
                  "type": "integer",
                  "format": "int64"
                },
                "description": {
                  "type": "string"
                },
                "srcIPNet": {
                  "type": "string"
                },
                "dstIPNet": {
                  "type": "string",
                  "title": "usually, the endpoint addr"
                },
                "proto": {
                  "$ref": "#/definitions/topologyProtocol"
                },
                "dstPort": {
                  "type": "integer",
                  "format": "int64"
                },
                "policy": {
                  "$ref": "#/definitions/topologySecurityPolicy",
                  "title": "ACCEPT, DROP"
                }
              }
            }
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{subnetReq.accountID}/tenants/{subnetReq.tenantID}/networks/{subnetReq.netID}/subnets/{subnetReq.subnetID}/policy/{nfID}": {
      "delete": {
        "summary": "Deletes a network filter in the subnet security policy.",
        "operationId": "TopologyAPI_DeleteNetworkFilter",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyPolicy"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "subnetReq.accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnetReq.tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnetReq.netID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnetReq.subnetID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "nfID",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      },
      "put": {
        "summary": "Updates a network filter in the subnet security policy.",
        "operationId": "TopologyAPI_UpdateNetworkFilter",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyPolicy"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "subnetReq.accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnetReq.tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnetReq.netID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "subnetReq.subnetID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "nfID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "subnetReq": {
                  "type": "object"
                },
                "index": {
                  "type": "integer",
                  "format": "int64"
                },
                "description": {
                  "type": "string"
                },
                "srcIPNet": {
                  "type": "string"
                },
                "dstIPNet": {
                  "type": "string",
                  "title": "usually, the endpoint addr"
                },
                "proto": {
                  "$ref": "#/definitions/topologyProtocol"
                },
                "dstPort": {
                  "type": "integer",
                  "format": "int64"
                },
                "policy": {
                  "$ref": "#/definitions/topologySecurityPolicy",
                  "title": "ACCEPT, DROP"
                }
              }
            }
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{tenant.accountID}/tenants/{tenant.tenantID}/networks": {
      "post": {
        "summary": "Lists networks in a tenant.",
        "operationId": "TopologyAPI_ListNetworks",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyNetworks"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "tenant.accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenant.tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "meta": {
                  "$ref": "#/definitions/resourceListRequest"
                },
                "tenant": {
                  "type": "object"
                }
              }
            }
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    },
    "/api/v1/accounts/{tenant.accountID}/tenants/{tenant.tenantID}/nodes": {
      "post": {
        "summary": "Lists nodes by tenant.",
        "operationId": "TopologyAPI_ListNodesByTenant",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/topologyNodes"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/googlerpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "tenant.accountID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "tenant.tenantID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "meta": {
                  "$ref": "#/definitions/resourceListRequest"
                },
                "tenant": {
                  "type": "object"
                }
              }
            }
          }
        ],
        "tags": [
          "TopologyAPI"
        ]
      }
    }
  },
  "definitions": {
    "datetimeDateTime": {
      "type": "object",
      "properties": {
        "year": {
          "type": "integer",
          "format": "int32"
        },
        "month": {
          "type": "integer",
          "format": "int32"
        },
        "day": {
          "type": "integer",
          "format": "int32"
        },
        "hour": {
          "type": "integer",
          "format": "int32"
        },
        "minute": {
          "type": "integer",
          "format": "int32"
        },
        "second": {
          "type": "integer",
          "format": "int32"
        }
      }
    },
    "emptyResponse": {
      "type": "object"
    },
    "eventsEventMetrics": {
      "type": "object",
      "properties": {
        "successCount": {
          "type": "number",
          "format": "float"
        },
        "failCount": {
          "type": "number",
          "format": "float"
        },
        "successProbability": {
          "type": "number",
          "format": "float"
        },
        "failProbability": {
          "type": "number",
          "format": "float"
        },
        "firstActivity": {
          "type": "string",
          "format": "int64"
        },
        "lastActivity": {
          "type": "string",
          "format": "int64"
        },
        "activityIndex": {
          "type": "number",
          "format": "float"
        },
        "score": {
          "type": "number",
          "format": "float"
        },
        "rating": {
          "type": "string"
        },
        "lastResult": {
          "$ref": "#/definitions/eventsEventResult"
        }
      }
    },
    "eventsEventResult": {
      "type": "string",
      "enum": [
        "UNKNOWN_RESULT",
        "SUCCESS",
        "FAIL"
      ],
      "default": "UNKNOWN_RESULT"
    },
    "googlerpcStatus": {
      "type": "object",
      "properties": {
        "code": {
          "type": "integer",
          "format": "int32"
        },
        "message": {
          "type": "string"
        },
        "details": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/protobufAny"
          }
        }
      }
    },
    "hsecBOMMetadata": {
      "type": "object",
      "properties": {
        "timestamp": {
          "type": "string"
        },
        "component": {
          "$ref": "#/definitions/hsecComponent"
        }
      }
    },
    "hsecBuildInfo": {
      "type": "object",
      "properties": {
        "contentSets": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "nvr": {
          "type": "string"
        },
        "arch": {
          "type": "string"
        }
      }
    },
    "hsecCVSS": {
      "type": "object",
      "properties": {
        "v2Vector": {
          "type": "string"
        },
        "v3Vector": {
          "type": "string"
        },
        "v2Score": {
          "type": "number",
          "format": "double"
        },
        "v3Score": {
          "type": "number",
          "format": "double"
        }
      }
    },
    "hsecCauseMetadata": {
      "type": "object",
      "properties": {
        "resource": {
          "type": "string"
        },
        "provider": {
          "type": "string"
        },
        "service": {
          "type": "string"
        },
        "startLine": {
          "type": "integer",
          "format": "int32"
        },
        "endLine": {
          "type": "integer",
          "format": "int32"
        },
        "code": {
          "$ref": "#/definitions/hsecCode"
        },
        "occurrences": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/hsecOccurrence"
          }
        }
      }
    },
    "hsecCode": {
      "type": "object",
      "properties": {
        "lines": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/hsecLine"
          }
        }
      }
    },
    "hsecComponent": {
      "type": "object",
      "properties": {
        "BOMRef": {
          "type": "string"
        },
        "MIMEType": {
          "type": "string"
        },
        "type": {
          "type": "string",
          "title": "ComponentType"
        },
        "name": {
          "type": "string"
        },
        "version": {
          "type": "string"
        },
        "packageURL": {
          "type": "string"
        }
      }
    },
    "hsecConfig": {
      "type": "object",
      "properties": {
        "attachStderr": {
          "type": "boolean"
        },
        "attachStdin": {
          "type": "boolean"
        },
        "attachStdout": {
          "type": "boolean"
        },
        "cmd": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "healthcheck": {
          "$ref": "#/definitions/hsecHealthConfig"
        },
        "domainName": {
          "type": "string"
        },
        "entrypoint": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "env": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "hostname": {
          "type": "string"
        },
        "image": {
          "type": "string"
        },
        "labels": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        },
        "onBuild": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "openStdin": {
          "type": "boolean"
        },
        "stdinOnce": {
          "type": "boolean"
        },
        "tty": {
          "type": "boolean"
        },
        "user": {
          "type": "string"
        },
        "volumes": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "title": "map[string]struct{}"
        },
        "workingDir": {
          "type": "string"
        },
        "exposedPorts": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "title": "map[string]struct{}"
        },
        "argsEscaped": {
          "type": "boolean"
        },
        "networkDisabled": {
          "type": "boolean"
        },
        "macAddress": {
          "type": "string"
        },
        "stopSignal": {
          "type": "string"
        },
        "shell": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "hsecConfigFile": {
      "type": "object",
      "properties": {
        "architecture": {
          "type": "string"
        },
        "author": {
          "type": "string"
        },
        "container": {
          "type": "string"
        },
        "created": {
          "type": "string",
          "format": "int64"
        },
        "dockerVersion": {
          "type": "string"
        },
        "history": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/hsecHistory"
          }
        },
        "OS": {
          "type": "string"
        },
        "rootFS": {
          "$ref": "#/definitions/hsecRootFS"
        },
        "config": {
          "$ref": "#/definitions/hsecConfig"
        },
        "OSVersion": {
          "type": "string"
        },
        "variant": {
          "type": "string"
        },
        "OSFeatures": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "hsecCustomResource": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string"
        },
        "filePath": {
          "type": "string"
        },
        "layer": {
          "$ref": "#/definitions/hsecLayer",
          "title": "interface{} data = 41;"
        }
      }
    },
    "hsecCycloneDX": {
      "type": "object",
      "properties": {
        "BOMFormat": {
          "type": "string"
        },
        "specVersion": {
          "type": "integer",
          "format": "int32"
        },
        "serialNumber": {
          "type": "string"
        },
        "version": {
          "type": "integer",
          "format": "int32"
        },
        "metadata": {
          "$ref": "#/definitions/hsecBOMMetadata"
        },
        "components": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/hsecComponent"
          }
        }
      }
    },
    "hsecDataSource": {
      "type": "object",
      "properties": {
        "ID": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "URL": {
          "type": "string"
        }
      }
    },
    "hsecDetectedLicense": {
      "type": "object",
      "properties": {
        "severity": {
          "type": "string"
        },
        "category": {
          "type": "string",
          "title": "licenseCategory"
        },
        "pkgName": {
          "type": "string"
        },
        "filePath": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "confidence": {
          "type": "number",
          "format": "double"
        },
        "link": {
          "type": "string"
        }
      }
    },
    "hsecDetectedMisconfiguration": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string"
        },
        "ID": {
          "type": "string"
        },
        "AVDID": {
          "type": "string"
        },
        "title": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "message": {
          "type": "string"
        },
        "namespace": {
          "type": "string"
        },
        "query": {
          "type": "string"
        },
        "resolution": {
          "type": "string"
        },
        "severity": {
          "type": "string"
        },
        "primaryURL": {
          "type": "string"
        },
        "references": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "status": {
          "$ref": "#/definitions/hsecMisconfStatus"
        },
        "layer": {
          "$ref": "#/definitions/hsecLayer"
        },
        "causeMetadata": {
          "$ref": "#/definitions/hsecCauseMetadata"
        },
        "traces": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "hsecDetectedVulnerability": {
      "type": "object",
      "properties": {
        "vulnerabilityID": {
          "type": "string"
        },
        "vendorIDs": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "pkgID": {
          "type": "string"
        },
        "pkgName": {
          "type": "string"
        },
        "pkgPath": {
          "type": "string"
        },
        "installedVersion": {
          "type": "string"
        },
        "fixedVersion": {
          "type": "string"
        },
        "status": {
          "$ref": "#/definitions/hsecVulnerabilityStatus"
        },
        "layer": {
          "$ref": "#/definitions/hsecLayer"
        },
        "severitySource": {
          "type": "string"
        },
        "primaryURL": {
          "type": "string"
        },
        "pkgRef": {
          "type": "string"
        },
        "dataSource": {
          "$ref": "#/definitions/hsecDataSource"
        },
        "vulnerability": {
          "$ref": "#/definitions/hsecVulnerability"
        }
      }
    },
    "hsecHash": {
      "type": "object",
      "properties": {
        "algorithm": {
          "type": "string"
        },
        "hex": {
          "type": "string"
        }
      }
    },
    "hsecHealthConfig": {
      "type": "object",
      "properties": {
        "test": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "Test is the test to perform to check that the container is healthy.\nAn empty slice means to inherit the default.\nThe options are:\n{} : inherit healthcheck\n{\"NONE\"} : disable healthcheck\n{\"CMD\", args...} : exec arguments directly\n{\"CMD-SHELL\", command} : run command with system's default shell"
        },
        "interval": {
          "type": "string",
          "format": "int64",
          "description": "Zero means to inherit. Durations are expressed as integer nanoseconds.\nInterval is the time to wait between checks.\n\ntime.Duration"
        },
        "timeout": {
          "type": "string",
          "format": "int64",
          "description": "Timeout is the time to wait before considering the check to have hung.\n\ntime.Duration"
        },
        "startPeriod": {
          "type": "string",
          "format": "int64",
          "description": "The start period for the container to initialize before the retries starts to count down.\n\ntime.Duration"
        },
        "retries": {
          "type": "integer",
          "format": "int32",
          "description": "Retries is the number of consecutive failures needed to consider a container as unhealthy.\nZero means inherit."
        }
      }
    },
    "hsecHistory": {
      "type": "object",
      "properties": {
        "author": {
          "type": "string"
        },
        "created": {
          "type": "string",
          "format": "int64"
        },
        "createdBy": {
          "type": "string"
        },
        "comment": {
          "type": "string"
        },
        "emptyLayer": {
          "type": "boolean"
        }
      }
    },
    "hsecLayer": {
      "type": "object",
      "properties": {
        "digest": {
          "type": "string"
        },
        "diffID": {
          "type": "string"
        },
        "createdBy": {
          "type": "string"
        }
      }
    },
    "hsecLine": {
      "type": "object",
      "properties": {
        "number": {
          "type": "integer",
          "format": "int32"
        },
        "content": {
          "type": "string"
        },
        "isCause": {
          "type": "boolean"
        },
        "annotation": {
          "type": "string"
        },
        "truncated": {
          "type": "boolean"
        },
        "highlighted": {
          "type": "string"
        },
        "firstCause": {
          "type": "boolean"
        },
        "lastCause": {
          "type": "boolean"
        }
      }
    },
    "hsecLocation": {
      "type": "object",
      "properties": {
        "startLine": {
          "type": "integer",
          "format": "int32"
        },
        "endLine": {
          "type": "integer",
          "format": "int32"
        }
      }
    },
    "hsecMetadata": {
      "type": "object",
      "properties": {
        "size": {
          "type": "string",
          "format": "int64"
        },
        "OS": {
          "$ref": "#/definitions/hsecOS"
        },
        "imageID": {
          "type": "string",
          "title": "Container Image"
        },
        "diffIDs": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "repoTags": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "repoDigests": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "imageConfig": {
          "$ref": "#/definitions/hsecConfigFile"
        }
      }
    },
    "hsecMisconfStatus": {
      "type": "string",
      "enum": [
        "MISCONF_STATUS_UNKNOWN",
        "MISCONF_STATUS_PASSED",
        "MISCONF_STATUS_FAILURE",
        "MISCONF_STATUS_EXCEPTION"
      ],
      "default": "MISCONF_STATUS_UNKNOWN"
    },
    "hsecMisconfSummary": {
      "type": "object",
      "properties": {
        "successes": {
          "type": "integer",
          "format": "int32"
        },
        "failures": {
          "type": "integer",
          "format": "int32"
        },
        "exceptions": {
          "type": "integer",
          "format": "int32"
        }
      }
    },
    "hsecOS": {
      "type": "object",
      "properties": {
        "family": {
          "type": "string",
          "title": "OSType"
        },
        "name": {
          "type": "string"
        },
        "EOSL": {
          "type": "boolean"
        },
        "extended": {
          "type": "boolean",
          "description": "This field is used for enhanced security maintenance programs such as Ubuntu ESM, Debian Extended LTS."
        }
      }
    },
    "hsecOccurrence": {
      "type": "object",
      "properties": {
        "resource": {
          "type": "string"
        },
        "filename": {
          "type": "string"
        },
        "location": {
          "$ref": "#/definitions/hsecLocation"
        }
      }
    },
    "hsecPackage": {
      "type": "object",
      "properties": {
        "ID": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "version": {
          "type": "string"
        },
        "release": {
          "type": "string"
        },
        "epoch": {
          "type": "integer",
          "format": "int32"
        },
        "arch": {
          "type": "string"
        },
        "dev": {
          "type": "boolean"
        },
        "srcName": {
          "type": "string"
        },
        "srcVersion": {
          "type": "string"
        },
        "srcRelease": {
          "type": "string"
        },
        "srcEpoch": {
          "type": "integer",
          "format": "int32"
        },
        "licenses": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "maintainer": {
          "type": "string"
        },
        "modularityLabel": {
          "type": "string"
        },
        "buildInfo": {
          "$ref": "#/definitions/hsecBuildInfo"
        },
        "ref": {
          "type": "string"
        },
        "indirect": {
          "type": "boolean"
        },
        "dependsOn": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "layer": {
          "$ref": "#/definitions/hsecLayer"
        },
        "filePath": {
          "type": "string"
        },
        "digest": {
          "type": "string"
        },
        "locations": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/hsecLocation"
          }
        },
        "installedFiles": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "hsecReport": {
      "type": "object",
      "properties": {
        "schemaVersion": {
          "type": "integer",
          "format": "int32"
        },
        "createdAt": {
          "type": "string",
          "format": "int64"
        },
        "artifactName": {
          "type": "string"
        },
        "artifactType": {
          "type": "string",
          "title": "ArtifactType"
        },
        "metadata": {
          "$ref": "#/definitions/hsecMetadata"
        },
        "results": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/hsecResult"
          }
        },
        "cycloneDX": {
          "$ref": "#/definitions/hsecCycloneDX",
          "title": "SBOM"
        }
      }
    },
    "hsecResult": {
      "type": "object",
      "properties": {
        "target": {
          "type": "string"
        },
        "class": {
          "type": "string"
        },
        "type": {
          "type": "string"
        },
        "packages": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/hsecPackage"
          }
        },
        "vulnerabilities": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/hsecDetectedVulnerability"
          }
        },
        "misconfSummary": {
          "$ref": "#/definitions/hsecMisconfSummary"
        },
        "misconfigurations": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/hsecDetectedMisconfiguration"
          }
        },
        "secrets": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/hsecSecretFinding"
          }
        },
        "licenses": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/hsecDetectedLicense"
          }
        },
        "customResources": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/hsecCustomResource"
          }
        }
      }
    },
    "hsecRootFS": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string"
        },
        "diffIDs": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/hsecHash"
          }
        }
      }
    },
    "hsecSecretFinding": {
      "type": "object",
      "properties": {
        "ruleID": {
          "type": "string"
        },
        "category": {
          "type": "string",
          "title": "secretRuleCategory"
        },
        "severity": {
          "type": "string"
        },
        "title": {
          "type": "string"
        },
        "startLine": {
          "type": "integer",
          "format": "int32"
        },
        "endLine": {
          "type": "integer",
          "format": "int32"
        },
        "code": {
          "$ref": "#/definitions/hsecCode"
        },
        "match": {
          "type": "string"
        },
        "layer": {
          "$ref": "#/definitions/hsecLayer"
        }
      }
    },
    "hsecSeverity": {
      "type": "string",
      "enum": [
        "SEVERITY_UNKNOWN",
        "SEVERITY_LOW",
        "SEVERITY_MEDIUM",
        "SEVERITY_HIGH",
        "SEVERITY_CRITICAL"
      ],
      "default": "SEVERITY_UNKNOWN"
    },
    "hsecVulnerability": {
      "type": "object",
      "properties": {
        "title": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "severity": {
          "type": "string"
        },
        "cweIDs": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "vendorSeverity": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/hsecSeverity"
          },
          "title": "map[sourceID]*Severity"
        },
        "CVSS": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/hsecCVSS"
          },
          "title": "map[sourceID]*CVSS"
        },
        "references": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "publishedDate": {
          "type": "string",
          "format": "int64"
        },
        "lastModifiedDate": {
          "type": "string",
          "format": "int64"
        }
      }
    },
    "hsecVulnerabilityStatus": {
      "type": "string",
      "enum": [
        "STATUS_UNKNOWN",
        "STATUS_NOT_AFFECTED",
        "STATUS_AFFECTED",
        "STATUS_FIXED",
        "STATUS_UNDER_INVESTIGATION",
        "STATUS_WILL_NOT_FIX",
        "STATUS_FIX_DEFERRED",
        "STATUS_END_OF_LIFE"
      ],
      "default": "STATUS_UNKNOWN"
    },
    "hsecdbHostSecurityReportResponse": {
      "type": "object",
      "properties": {
        "accountID": {
          "type": "string"
        },
        "tenantID": {
          "type": "string"
        },
        "nodeID": {
          "type": "string"
        },
        "queryID": {
          "type": "string"
        },
        "report": {
          "$ref": "#/definitions/hsecReport"
        },
        "timestamp": {
          "type": "string",
          "format": "int64"
        }
      }
    },
    "metricsdbHostMetricType": {
      "type": "string",
      "enum": [
        "UNDEFINED",
        "NET_RX_BYTES",
        "NET_TX_BYTES",
        "HOST_LOAD_AVG",
        "HOST_CPU_USAGE",
        "HOST_MEM_USAGE",
        "HOST_DISK_USAGE"
      ],
      "default": "UNDEFINED",
      "title": "- NET_TX_BYTES: NET_RX_PKTS = 21;\n NET_TX_PKTS = 22;\n NET_DROPPED_PKTS = 23;"
    },
    "metricsdbHostMetrics": {
      "type": "object",
      "properties": {
        "loadAvg": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/metricsdbTimeValue"
          }
        },
        "cpuUsage": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/metricsdbTimeValue"
          }
        },
        "memUsage": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/metricsdbTimeValue"
          }
        },
        "diskUsage": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/metricsdbTimeValue"
          }
        },
        "netUsage": {
          "$ref": "#/definitions/metricsdbNetMetrics"
        }
      }
    },
    "metricsdbHostMetricsResponse": {
      "type": "object",
      "properties": {
        "accountID": {
          "type": "string"
        },
        "tenantID": {
          "type": "string"
        },
        "nodeID": {
          "type": "string"
        },
        "queryID": {
          "type": "string"
        },
        "metrics": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/metricsdbHostMetrics"
          },
          "title": "map[TimeRange.String()]*HostMetrics"
        },
        "timestamp": {
          "type": "string",
          "format": "int64"
        }
      }
    },
    "metricsdbNetMetrics": {
      "type": "object",
      "properties": {
        "netRxBytes": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/metricsdbTimeValue"
          }
        },
        "netTxBytes": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/metricsdbTimeValue"
          }
        }
      }
    },
    "metricsdbTimeValue": {
      "type": "object",
      "properties": {
        "timestamp": {
          "type": "string",
          "format": "int64"
        },
        "value": {
          "type": "number",
          "format": "double"
        }
      }
    },
    "netdbAddressFamily": {
      "type": "string",
      "enum": [
        "UNKNOWN_AF",
        "IP4",
        "IP6"
      ],
      "default": "UNKNOWN_AF"
    },
    "netdbConnection": {
      "type": "object",
      "properties": {
        "AF": {
          "$ref": "#/definitions/netdbAddressFamily"
        },
        "srcIP": {
          "type": "string"
        },
        "dstIP": {
          "type": "string"
        },
        "proto": {
          "$ref": "#/definitions/netdbProtocol",
          "title": "string dstAddr = 22;"
        },
        "srcPort": {
          "type": "integer",
          "format": "int64"
        },
        "dstPort": {
          "type": "integer",
          "format": "int64"
        }
      }
    },
    "netdbConnectionState": {
      "type": "object",
      "properties": {
        "status": {
          "$ref": "#/definitions/netdbConnectionStatus"
        },
        "firstSeen": {
          "type": "string",
          "format": "int64"
        },
        "timeout": {
          "type": "string",
          "format": "int64"
        },
        "originCounter": {
          "$ref": "#/definitions/netdbTrafficCounter"
        },
        "replyCounter": {
          "$ref": "#/definitions/netdbTrafficCounter"
        }
      }
    },
    "netdbConnectionStatus": {
      "type": "string",
      "enum": [
        "UNKNOWN_STATUS",
        "NEW",
        "ACTIVE",
        "DROPPED"
      ],
      "default": "UNKNOWN_STATUS"
    },
    "netdbConntrackEntry": {
      "type": "object",
      "properties": {
        "timestamp": {
          "type": "string",
          "format": "int64"
        },
        "connection": {
          "$ref": "#/definitions/netdbConnection"
        },
        "state": {
          "$ref": "#/definitions/netdbConnectionState"
        }
      }
    },
    "netdbConntrackLogEntry": {
      "type": "object",
      "properties": {
        "timestamp": {
          "type": "string",
          "format": "int64"
        },
        "connection": {
          "$ref": "#/definitions/netdbConnection",
          "title": "key"
        },
        "status": {
          "$ref": "#/definitions/netdbConnectionStatus",
          "title": "value"
        }
      }
    },
    "netdbConntrackLogResponse": {
      "type": "object",
      "properties": {
        "accountID": {
          "type": "string"
        },
        "tenantID": {
          "type": "string"
        },
        "nodeID": {
          "type": "string"
        },
        "queryID": {
          "type": "string"
        },
        "ctLog": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbConntrackLogEntry"
          }
        },
        "timestamp": {
          "type": "string",
          "format": "int64"
        }
      }
    },
    "netdbConntrackTableResponse": {
      "type": "object",
      "properties": {
        "accountID": {
          "type": "string"
        },
        "tenantID": {
          "type": "string"
        },
        "nodeID": {
          "type": "string"
        },
        "queryID": {
          "type": "string"
        },
        "ctTable": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbConntrackEntry"
          }
        },
        "timestamp": {
          "type": "string",
          "format": "int64"
        }
      }
    },
    "netdbProtocol": {
      "type": "string",
      "enum": [
        "UNKNOWN_PROTO",
        "TCP",
        "UDP",
        "ICMP4",
        "ICMP6",
        "GRE",
        "SCTP"
      ],
      "default": "UNKNOWN_PROTO"
    },
    "netdbTalker": {
      "type": "object",
      "properties": {
        "addr": {
          "type": "string"
        },
        "bytes": {
          "type": "string",
          "format": "uint64"
        }
      }
    },
    "netdbTimeTrafficValue": {
      "type": "object",
      "properties": {
        "timestamp": {
          "type": "string",
          "format": "int64"
        },
        "traffic": {
          "$ref": "#/definitions/netdbTrafficCounter"
        }
      }
    },
    "netdbTopTalkers": {
      "type": "object",
      "properties": {
        "src": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTalker"
          }
        },
        "dst": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTalker"
          }
        }
      }
    },
    "netdbTrafficByDirection": {
      "type": "object",
      "properties": {
        "incoming": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "outgoing": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        }
      }
    },
    "netdbTrafficByL5Port": {
      "type": "object",
      "properties": {
        "other": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "HTTP": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "HTTPS": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "SSH": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "RDP": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "DNS": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "SMTP": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "SMTPS": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "MailSubmission": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "IMAP": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "IMAPS": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "POP3": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "POP3S": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "NTP": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "SNMP": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "BGP": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "LDAP": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "LDAPS": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "MySQL": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "PostgreSQL": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "MSSQL": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "Redis": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "NFS": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "SIP": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "SIPTLS": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "AMQP": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "AMQPS": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        }
      }
    },
    "netdbTrafficByProtocol": {
      "type": "object",
      "properties": {
        "unknown": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "TCP": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "UDP": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "ICMPv4": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "ICMPv6": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "GRE": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        },
        "SCTP": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/netdbTimeTrafficValue"
          }
        }
      }
    },
    "netdbTrafficCounter": {
      "type": "object",
      "properties": {
        "packets": {
          "type": "string",
          "format": "uint64"
        },
        "bytes": {
          "type": "string",
          "format": "uint64"
        }
      }
    },
    "netdbTrafficMetricsResponse": {
      "type": "object",
      "properties": {
        "accountID": {
          "type": "string"
        },
        "tenantID": {
          "type": "string"
        },
        "nodeID": {
          "type": "string"
        },
        "queryID": {
          "type": "string"
        },
        "byProtocol": {
          "$ref": "#/definitions/netdbTrafficByProtocol"
        },
        "byL5Port": {
          "$ref": "#/definitions/netdbTrafficByL5Port"
        },
        "byDirection": {
          "$ref": "#/definitions/netdbTrafficByDirection"
        },
        "topTalkers": {
          "$ref": "#/definitions/netdbTopTalkers"
        },
        "timestamp": {
          "type": "string",
          "format": "int64"
        }
      }
    },
    "netdbTrafficQueryType": {
      "type": "string",
      "enum": [
        "UNKNOWN_QUERY",
        "TRAFFIC_BY_PROTOCOL",
        "TRAFFIC_BY_L5_PORT",
        "TRAFFIC_BY_DIRECTION",
        "TRAFFIC_TOP_TALKERS"
      ],
      "default": "UNKNOWN_QUERY"
    },
    "nstoreDataRequest": {
      "type": "object",
      "properties": {
        "accountID": {
          "type": "string"
        },
        "tenantID": {
          "type": "string"
        },
        "nodeID": {
          "type": "string"
        },
        "controllerID": {
          "type": "string"
        },
        "queryID": {
          "type": "string"
        }
      }
    },
    "nstoreTimeRange": {
      "type": "string",
      "enum": [
        "TTL_UNDEFINED",
        "TTL_1H",
        "TTL_6H",
        "TTL_12H",
        "TTL_24H",
        "TTL_7D",
        "TTL_14D",
        "TTL_30D",
        "TTL_365D"
      ],
      "default": "TTL_UNDEFINED",
      "title": "- TTL_1H: 1H - 60min       / 30 samples - 1 point per 2min\n - TTL_6H: 6H - 360min      / 30 samples - 1 point per 12min\n - TTL_12H: 12H - 720min     / 30 samples - 1 point per 24min\n - TTL_24H: 24H - 1440min    / 30 samples - 1 point per 48min\n - TTL_7D: 7D - 10080min    / 30 samples - 1 point per 336min\n - TTL_14D: 14D - 20160min   / 30 samples - 1 point per 672min\n - TTL_30D: 30D - 40320min   / 30 samples - 1 point per 1344min\n - TTL_365D: 365D - 525600min / 30 samples - 1 point per 12days"
    },
    "protobufAny": {
      "type": "object",
      "properties": {
        "@type": {
          "type": "string"
        }
      },
      "additionalProperties": {}
    },
    "resourceListRequest": {
      "type": "object",
      "properties": {
        "pageToken": {
          "type": "string"
        },
        "pageSize": {
          "type": "integer",
          "format": "int32"
        }
      }
    },
    "resourceListResponse": {
      "type": "object",
      "properties": {
        "nextPageToken": {
          "type": "string"
        }
      }
    },
    "tenantTenantReq": {
      "type": "object",
      "properties": {
        "accountID": {
          "type": "string"
        },
        "tenantID": {
          "type": "string"
        }
      }
    },
    "topologyAgent": {
      "type": "object",
      "properties": {
        "P2PHostID": {
          "type": "string"
        },
        "hostname": {
          "type": "string"
        },
        "port": {
          "type": "integer",
          "format": "int32"
        },
        "DNSPort": {
          "type": "integer",
          "format": "int32",
          "title": "string transport = 12;"
        },
        "externalIPv4": {
          "type": "string"
        },
        "externalPort": {
          "type": "integer",
          "format": "int32"
        },
        "canRelay": {
          "type": "boolean"
        },
        "MAddrs": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "routes": {
          "$ref": "#/definitions/topologyRoutes"
        },
        "metrics": {
          "$ref": "#/definitions/topologyAgentMetrics"
        },
        "version": {
          "type": "string"
        },
        "devMode": {
          "type": "boolean"
        }
      }
    },
    "topologyAgentMetrics": {
      "type": "object",
      "properties": {
        "lastUpdated": {
          "type": "string",
          "format": "int64"
        },
        "hostMetrics": {
          "$ref": "#/definitions/topologyHostMetrics"
        }
      }
    },
    "topologyAlertMetrics": {
      "type": "object",
      "properties": {
        "totalAlerts": {
          "type": "integer",
          "format": "int32"
        },
        "totalTriggered": {
          "type": "integer",
          "format": "int32"
        },
        "totalResolved": {
          "type": "integer",
          "format": "int32"
        },
        "totalInfo": {
          "type": "integer",
          "format": "int32"
        },
        "totalWarning": {
          "type": "integer",
          "format": "int32"
        },
        "totalError": {
          "type": "integer",
          "format": "int32"
        },
        "totalCritical": {
          "type": "integer",
          "format": "int32"
        }
      }
    },
    "topologyEndpoint": {
      "type": "object",
      "properties": {
        "endpointID": {
          "type": "string"
        },
        "IPv4": {
          "type": "string"
        },
        "IPv6": {
          "type": "string"
        },
        "DNSName": {
          "type": "string"
        },
        "reqIPv4": {
          "type": "string",
          "description": "string QoS_network_class = 41;\n NetworkObjectClass networkObjectClass = 51;",
          "title": "string DNSDomain = 5;\nstring FQDN = 6;"
        }
      }
    },
    "topologyFilter": {
      "type": "object",
      "properties": {
        "nfID": {
          "type": "string"
        },
        "index": {
          "type": "integer",
          "format": "int64"
        },
        "description": {
          "type": "string"
        },
        "srcIPNet": {
          "type": "string"
        },
        "dstIPNet": {
          "type": "string",
          "title": "usually, the endpoint addr"
        },
        "proto": {
          "$ref": "#/definitions/topologyProtocol"
        },
        "dstPort": {
          "type": "integer",
          "format": "int64"
        },
        "policy": {
          "$ref": "#/definitions/topologySecurityPolicy",
          "title": "ACCEPT, DROP"
        }
      }
    },
    "topologyHostMetrics": {
      "type": "object",
      "properties": {
        "OS": {
          "type": "string"
        },
        "uptime": {
          "type": "string"
        },
        "loadAvg": {
          "type": "number",
          "format": "double"
        },
        "cpuUsage": {
          "type": "string",
          "format": "uint64"
        },
        "cpuPressure": {
          "type": "boolean"
        },
        "memoryUsage": {
          "type": "string",
          "format": "uint64"
        },
        "memoryPressure": {
          "type": "boolean"
        },
        "diskUsage": {
          "type": "string",
          "format": "uint64"
        },
        "diskPressure": {
          "type": "boolean"
        }
      }
    },
    "topologyHostStats": {
      "type": "object",
      "properties": {
        "totalLinux": {
          "type": "integer",
          "format": "int32"
        },
        "totalMac": {
          "type": "integer",
          "format": "int32"
        },
        "totalWindows": {
          "type": "integer",
          "format": "int32"
        }
      }
    },
    "topologyIPAM": {
      "type": "object",
      "properties": {
        "networkCIDR": {
          "type": "string"
        },
        "subnetCIDR": {
          "type": "string"
        },
        "endpoints": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "title": "map[endpointID]ipv4"
        },
        "leased": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/topologyLeaseEndpointMap"
          },
          "title": "map[ipv4]map[endpointID]bool \u0026 map[ipv4]map[nodeID]bool"
        },
        "available": {
          "type": "object",
          "additionalProperties": {
            "type": "boolean"
          },
          "title": "map[ipv4]bool"
        },
        "totalAvailable": {
          "type": "integer",
          "format": "int32"
        },
        "totalLeased": {
          "type": "integer",
          "format": "int32"
        }
      }
    },
    "topologyKubernetesAttrs": {
      "type": "object",
      "properties": {
        "namespace": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "image": {
          "type": "string",
          "title": "string podName = 11;"
        },
        "persistentVolume": {
          "type": "boolean",
          "title": "persistent storage volume for metrics and other data"
        }
      }
    },
    "topologyLeaseEndpointMap": {
      "type": "object",
      "properties": {
        "endpoints": {
          "type": "object",
          "additionalProperties": {
            "type": "boolean"
          },
          "title": "map[endpointID]bool"
        },
        "nodes": {
          "type": "object",
          "additionalProperties": {
            "type": "boolean"
          },
          "title": "map[nodeID]bool (counts how many nodes have the same endpoint (same ip))"
        }
      }
    },
    "topologyLinkStatus": {
      "type": "object",
      "properties": {
        "totalNodes": {
          "type": "integer",
          "format": "int32"
        },
        "onlineNodes": {
          "type": "integer",
          "format": "int32"
        },
        "offlineNodes": {
          "type": "integer",
          "format": "int32"
        }
      }
    },
    "topologyMetrics": {
      "type": "object",
      "properties": {
        "linkStatus": {
          "$ref": "#/definitions/topologyLinkStatus"
        },
        "hosts": {
          "$ref": "#/definitions/topologyHostStats"
        },
        "alerts": {
          "$ref": "#/definitions/topologyAlertMetrics"
        }
      }
    },
    "topologyNetwork": {
      "type": "object",
      "properties": {
        "accountID": {
          "type": "string"
        },
        "tenantID": {
          "type": "string"
        },
        "netID": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "networkCIDR": {
          "type": "string"
        },
        "routedSubnets": {
          "type": "boolean",
          "title": "connect subnets within the network"
        },
        "locationID": {
          "type": "string"
        }
      }
    },
    "topologyNetworkReq": {
      "type": "object",
      "properties": {
        "accountID": {
          "type": "string"
        },
        "tenantID": {
          "type": "string"
        },
        "netID": {
          "type": "string"
        }
      }
    },
    "topologyNetworks": {
      "type": "object",
      "properties": {
        "meta": {
          "$ref": "#/definitions/resourceListResponse"
        },
        "networks": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/topologyNetwork"
          }
        }
      }
    },
    "topologyNode": {
      "type": "object",
      "properties": {
        "accountID": {
          "type": "string"
        },
        "tenantID": {
          "type": "string"
        },
        "nodeID": {
          "type": "string"
        },
        "nodeGroupID": {
          "type": "string"
        },
        "nodeHostID": {
          "type": "string"
        },
        "nodeToken": {
          "type": "string",
          "title": "b64-encoded NodeTokenPayload struct"
        },
        "cfg": {
          "$ref": "#/definitions/topologyNodeCfg"
        },
        "agent": {
          "$ref": "#/definitions/topologyAgent"
        },
        "endpoints": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/topologyEndpoint"
          },
          "title": "map[endpointID]*Endpoint"
        },
        "eventMetrics": {
          "$ref": "#/definitions/eventsEventMetrics"
        },
        "type": {
          "$ref": "#/definitions/topologyNodeType"
        },
        "replicaSet": {
          "type": "boolean"
        },
        "kubernetesAttrs": {
          "$ref": "#/definitions/topologyKubernetesAttrs"
        },
        "lastSeen": {
          "type": "string",
          "format": "int64"
        }
      }
    },
    "topologyNodeCfg": {
      "type": "object",
      "properties": {
        "nodeName": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "netID": {
          "type": "string"
        },
        "subnetID": {
          "type": "string"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "priority": {
          "type": "integer",
          "format": "int32"
        },
        "disableRelay": {
          "type": "boolean"
        },
        "disableNetworking": {
          "type": "boolean"
        },
        "management": {
          "$ref": "#/definitions/topologyNodeManagement"
        },
        "maintenance": {
          "$ref": "#/definitions/topologyNodeMaintenance"
        }
      }
    },
    "topologyNodeInstance": {
      "type": "object",
      "properties": {
        "node": {
          "$ref": "#/definitions/topologyNode"
        },
        "config": {
          "$ref": "#/definitions/topologyNodeInstanceConfig"
        }
      }
    },
    "topologyNodeInstanceConfig": {
      "type": "object",
      "properties": {
        "YAML": {
          "type": "string"
        }
      }
    },
    "topologyNodeMaintenance": {
      "type": "object",
      "properties": {
        "autoUpdate": {
          "type": "boolean"
        },
        "schedule": {
          "$ref": "#/definitions/datetimeDateTime"
        }
      }
    },
    "topologyNodeManagement": {
      "type": "object",
      "properties": {
        "disableExec": {
          "type": "boolean"
        },
        "disableTransfer": {
          "type": "boolean"
        },
        "disablePortForwarding": {
          "type": "boolean"
        },
        "disableOps": {
          "type": "boolean"
        }
      }
    },
    "topologyNodeReq": {
      "type": "object",
      "properties": {
        "accountID": {
          "type": "string"
        },
        "tenantID": {
          "type": "string"
        },
        "nodeID": {
          "type": "string"
        }
      }
    },
    "topologyNodeSummary": {
      "type": "object",
      "properties": {
        "accountID": {
          "type": "string"
        },
        "tenantID": {
          "type": "string"
        },
        "tenantName": {
          "type": "string"
        },
        "tenantDescription": {
          "type": "string"
        },
        "netID": {
          "type": "string"
        },
        "networkDescription": {
          "type": "string"
        },
        "networkCIDR": {
          "type": "string"
        },
        "networkLocationID": {
          "type": "string"
        },
        "subnetID": {
          "type": "string"
        },
        "subnetDescription": {
          "type": "string"
        },
        "subnetCIDR": {
          "type": "string"
        },
        "nodeID": {
          "type": "string"
        },
        "nodeName": {
          "type": "string"
        },
        "nodeDescription": {
          "type": "string"
        },
        "nodeCanRelay": {
          "type": "boolean"
        },
        "nodeKubernetesGw": {
          "type": "boolean"
        },
        "nodeOffline": {
          "type": "boolean"
        }
      }
    },
    "topologyNodeSummaryMap": {
      "type": "object",
      "properties": {
        "nodes": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/topologyNodeSummary"
          },
          "title": "map[nodeID]*NodeSummary"
        }
      }
    },
    "topologyNodeType": {
      "type": "string",
      "enum": [
        "GENERIC",
        "K8S_GATEWAY",
        "K8S_POD"
      ],
      "default": "GENERIC"
    },
    "topologyNodes": {
      "type": "object",
      "properties": {
        "meta": {
          "$ref": "#/definitions/resourceListResponse"
        },
        "nodes": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/topologyNode"
          }
        }
      }
    },
    "topologyPolicy": {
      "type": "object",
      "properties": {
        "defaultPolicy": {
          "$ref": "#/definitions/topologySecurityPolicy",
          "title": "ACCEPT, DROP"
        },
        "networkFilters": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/topologyFilter"
          },
          "title": "map\u003cstring, Filter\u003e networkFilters = 11;  // map[nfID]*NetworkFilter"
        },
        "lastModified": {
          "type": "string",
          "format": "int64"
        }
      }
    },
    "topologyProtocol": {
      "type": "string",
      "enum": [
        "ANY",
        "TCP",
        "UDP",
        "ICMPv4",
        "ICMPv6"
      ],
      "default": "ANY"
    },
    "topologyRoutes": {
      "type": "object",
      "properties": {
        "export": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "import": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "topologySecurityPolicy": {
      "type": "string",
      "enum": [
        "ACCEPT",
        "DROP"
      ],
      "default": "ACCEPT"
    },
    "topologyStats": {
      "type": "object",
      "properties": {
        "totalNetworks": {
          "type": "integer",
          "format": "int32"
        },
        "totalSubnets": {
          "type": "integer",
          "format": "int32"
        },
        "totalNodes": {
          "type": "integer",
          "format": "int32"
        },
        "totalEndpoints": {
          "type": "integer",
          "format": "int32"
        },
        "metrics": {
          "$ref": "#/definitions/topologyMetrics"
        }
      }
    },
    "topologySubnet": {
      "type": "object",
      "properties": {
        "accountID": {
          "type": "string"
        },
        "tenantID": {
          "type": "string"
        },
        "netID": {
          "type": "string"
        },
        "subnetID": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "IPAM": {
          "$ref": "#/definitions/topologyIPAM"
        },
        "networkPolicy": {
          "$ref": "#/definitions/topologyPolicy"
        }
      }
    },
    "topologySubnetReq": {
      "type": "object",
      "properties": {
        "accountID": {
          "type": "string"
        },
        "tenantID": {
          "type": "string"
        },
        "netID": {
          "type": "string"
        },
        "subnetID": {
          "type": "string"
        }
      }
    },
    "topologySubnets": {
      "type": "object",
      "properties": {
        "meta": {
          "$ref": "#/definitions/resourceListResponse"
        },
        "Subnets": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/topologySubnet"
          }
        }
      }
    },
    "topologyTopology": {
      "type": "object",
      "properties": {
        "stats": {
          "$ref": "#/definitions/topologyStats"
        },
        "networks": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/topologyTopologyNetwork"
          }
        }
      }
    },
    "topologyTopologyNetwork": {
      "type": "object",
      "properties": {
        "network": {
          "$ref": "#/definitions/topologyNetwork"
        },
        "subnets": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/topologyTopologySubnet"
          }
        },
        "metrics": {
          "$ref": "#/definitions/topologyMetrics"
        }
      }
    },
    "topologyTopologyNode": {
      "type": "object",
      "properties": {
        "node": {
          "$ref": "#/definitions/topologyNode"
        },
        "endpoints": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/topologyEndpoint"
          }
        },
        "online": {
          "type": "boolean"
        },
        "alerts": {
          "$ref": "#/definitions/topologyAlertMetrics"
        }
      }
    },
    "topologyTopologySubnet": {
      "type": "object",
      "properties": {
        "subnet": {
          "$ref": "#/definitions/topologySubnet"
        },
        "nodes": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/topologyTopologyNode"
          }
        },
        "metrics": {
          "$ref": "#/definitions/topologyMetrics"
        }
      }
    }
  }
}
